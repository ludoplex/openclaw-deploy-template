# Security Tooling Reference

*Generated by seeker agent â€” 2026-02-04*

## Quick Start Recommendations

| Category | Tool | Why |
|----------|------|-----|
| **All-in-one** | Trivy | Containers, IaC, secrets, SBOM in one tool |
| **Python SAST** | Semgrep | Multi-language, custom rules, low false positives |
| **Dependencies** | pip-audit | Official PyPA tool, OSV database |
| **Secrets** | Gitleaks | Fast, accurate, great pre-commit hook |
| **API Testing** | Nuclei | 10k+ templates, YAML-based |

---

## 1. SAST (Static Analysis)

### Bandit (Python-focused)
```bash
pip install bandit
bandit -r ./src -f sarif -o bandit.sarif --severity-level medium
```

### Semgrep (Multi-language)
```yaml
- name: Semgrep Scan
  uses: returntocorp/semgrep-action@v1
  with:
    config: p/python p/security-audit p/owasp-top-ten
```

---

## 2. Dependency Scanning

### pip-audit (Recommended)
```yaml
- uses: pypa/gh-action-pip-audit@v1.1.0
  with:
    inputs: requirements.txt
    vulnerability-service: osv
```

### Safety
```bash
pip install safety
safety scan --output json
```

---

## 3. Secret Detection

### Gitleaks (CI)
```yaml
- uses: gitleaks/gitleaks-action@v2
  env:
    GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
```

### Gitleaks (Pre-commit)
```yaml
repos:
  - repo: https://github.com/gitleaks/gitleaks
    rev: v8.24.2
    hooks:
      - id: gitleaks
```

### Trufflehog (Verified secrets)
```bash
docker run --rm -v "$PWD:/pwd" trufflesecurity/trufflehog:latest \
  git file:///pwd --results=verified --fail
```

---

## 4. Container/IaC Scanning

### Trivy (All-in-one)
```yaml
- uses: aquasecurity/trivy-action@0.33.1
  with:
    scan-type: 'fs'
    scan-ref: '.'
    format: 'sarif'
    output: 'trivy.sarif'
    severity: 'CRITICAL,HIGH'
```

### Checkov (IaC-focused)
```yaml
- uses: bridgecrewio/checkov-action@master
  with:
    directory: .
    framework: terraform,dockerfile,kubernetes
```

---

## 5. API Security

### Nuclei
```bash
nuclei -u http://localhost:8000 -t http/cves/ -t http/misconfiguration/ \
  -severity critical,high -sarif-export nuclei.sarif
```

### OWASP ZAP (OpenAPI)
```yaml
- uses: zaproxy/action-api-scan@v0.7.0
  with:
    target: 'http://localhost:8000/openapi.json'
    format: openapi
```

---

## 6. SBOM Generation

### Syft
```bash
syft . -o cyclonedx-json=sbom.json
```

---

## Complete DevSecOps Pipeline

```yaml
name: Security Pipeline
on: [push, pull_request]

jobs:
  security-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      # Secret Detection (fastest, fail early)
      - uses: gitleaks/gitleaks-action@v2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      # SAST
      - name: Bandit
        run: |
          pip install bandit
          bandit -r src/ -f sarif -o bandit.sarif || true

      # Dependency Scanning
      - uses: pypa/gh-action-pip-audit@v1.1.0
        with:
          inputs: requirements.txt

      # IaC + Container + Filesystem
      - uses: aquasecurity/trivy-action@0.33.1
        with:
          scan-type: 'fs'
          scan-ref: '.'
          format: 'sarif'
          output: 'trivy.sarif'

      # Upload all SARIF for GitHub Security tab
      - uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: .
```

---

## Resources

- FastAPI official test workflow: https://github.com/tiangolo/fastapi/blob/master/.github/workflows/test.yml
- Ruff Action: https://github.com/marketplace/actions/ruff-action
- Trivy: https://github.com/aquasecurity/trivy
- pip-audit: https://github.com/pypa/pip-audit
- Gitleaks: https://github.com/gitleaks/gitleaks
- Semgrep: https://github.com/semgrep/semgrep
- Nuclei: https://github.com/projectdiscovery/nuclei
